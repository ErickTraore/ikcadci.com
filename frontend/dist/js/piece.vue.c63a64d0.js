(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["piece.vue"],{"48ad":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"Piece"},[i("PieceComponent")],1)},s=[],n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"group"},[e.loadingTemplate?i("div",{staticClass:"progress conteneur"},[i("pulse-loader",{attrs:{loading:e.loading,color:e.color,size:e.size}})],1):i("div",[i("div",{staticClass:"group__header",attrs:{id:"app"}},[i("div",{staticClass:"group__header__body"},e._l(e.pieces,(function(t){return i("div",{key:t.id,staticClass:"container"},[i("div",{staticClass:"group__header__body__first"},[i("div",{staticClass:"group__header__body__first__in"},[i("img",{attrs:{src:t.attachment}}),e._m(0,!0),i("b",[e._v(e._s(t.User.username))]),e._v(" à écrit le "+e._s(e._f("dateFormat")(new Date(t.createdAt),"DD/MM/YYYY"))+" à "+e._s(e._f("dateFormat")(new Date(t.createdAt),"hh:mm"))+" : "),i("br"),i("div",{staticClass:"group__header__body__first__title"},[e._v(" Titre: "+e._s(t.title)+" ")])]),i("div",{staticClass:"group__header__body__first__down"},[e._v(" "+e._s(t.content)),i("br")])]),i("div",{staticClass:"position like-buttons group__header__body__second",attrs:{"_ngcontent-cpa-c6":""}},[i("div",{staticClass:"left"},[i("div",{staticClass:"likes",attrs:{"_ngcontent-cpa-c6":""}},[i("button",{attrs:{id:"dolike"},on:{click:function(i){return e.doLike(t.id)}}},[i("i",{staticClass:"like fa-thumbs-up fa-lg far",attrs:{"_ngcontent-cpa-c6":""}})]),i("span",{staticClass:"spanLikes",attrs:{"_ngcontent-cpa-c6":""}},[e._v(e._s(t.likes))])]),i("div",{staticClass:"dislikes",attrs:{"_ngcontent-cpa-c6":""}},[i("button",{on:{click:function(i){return e.doDislike(t.id)}}},[i("i",{staticClass:"dislike fa-thumbs-down fa-lg far",attrs:{"_ngcontent-cpa-c6":""}})]),i("span",{staticClass:"spanDislikes",attrs:{"_ngcontent-cpa-c6":""}},[e._v(e._s(t.dislikes))])])]),i("div",{staticClass:"right"},[i("div",{staticClass:"dislikes",attrs:{"_ngcontent-cpa-c6":""}},[e.myId==t.UserId?i("button",{staticClass:"btn-1",on:{click:function(i){return e.doDelete(t.id)}}},[e._v(" Suppression ! ")]):e._e()])])]),i("ul")])})),0),i("div",{staticClass:"group__header__body"},[i("form",{attrs:{method:"post",enctype:"multipart/form-data",name:"piece"},on:{submit:e.onPostData}},[i("label",{staticClass:"labelForm"},[e._v("Nouveau piece avec image optionnelle")]),e._v(" "),i("br"),e._v(" "),i("br"),e.errors.length?i("p",[i("b",[e._v("Merci de corriger les erreurs suivantes : ")]),i("ul",e._l(e.errors,(function(t){return i("li",{key:t},[e._v(e._s(t))])})),0)]):e._e(),i("input",{directives:[{name:"model",rawName:"v-model",value:e.piece.title,expression:"piece.title"}],attrs:{id:"title",type:"text",name:"title",placeholder:"Titre"},domProps:{value:e.piece.title},on:{input:function(t){t.target.composing||e.$set(e.piece,"title",t.target.value)}}}),e._v(" "),i("br"),e._v(" "),i("br"),i("input",{directives:[{name:"model",rawName:"v-model",value:e.piece.content,expression:"piece.content"}],attrs:{id:"content",type:"text",name:"content",placeholder:"Contenu"},domProps:{value:e.piece.content},on:{input:function(t){t.target.composing||e.$set(e.piece,"content",t.target.value)}}}),i("input",{directives:[{name:"model",rawName:"v-model",value:e.piece.attachment,expression:"piece.attachment"}],attrs:{id:"attachment",type:"hidden",name:"attachment"},domProps:{value:e.piece.attachment},on:{input:function(t){t.target.composing||e.$set(e.piece,"attachment",t.target.value)}}}),i("br"),i("div",[e.image?i("div",[e.loadingImage?i("div",{staticClass:"progress"},[i("div",{staticClass:"value v-80 striped animate s-10"},[e._v("Chargement...")])]):i("div",[i("img",{attrs:{src:e.image}})]),i("button",{on:{click:e.removeImage}},[e._v("Remove image")])]):i("div",[i("h4",[e._v("Choisir une image")]),i("div",{attrs:{id:"list"}}),i("input",{attrs:{id:"file",type:"file",name:"attachment",alt:"example"},on:{change:e.onFileSelected}})])]),i("br"),i("br"),i("div"),i("button",{attrs:{type:"submit",value:"val"}},[e._v(" Envoyer")])])])])])])},o=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"progress-bar"}},[i("div")])}],r=i("b07d"),l=r["a"],c=(i("c79f"),i("2877")),p=Object(c["a"])(l,n,o,!1,null,null,null),d=p.exports,u={name:"Piece",components:{PieceComponent:d}},h=u,m=Object(c["a"])(h,a,s,!1,null,null,null);t["default"]=m.exports},"671b":function(e,t,i){"use strict";i("73af")},"73af":function(e,t,i){},"8a5d":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"v-spinner"},[i("div",{staticClass:"v-pulse v-pulse1",style:[e.spinnerStyle,e.spinnerDelay1]}),i("div",{staticClass:"v-pulse v-pulse2",style:[e.spinnerStyle,e.spinnerDelay2]}),i("div",{staticClass:"v-pulse v-pulse3",style:[e.spinnerStyle,e.spinnerDelay3]})])},s=[],n={name:"PulseLoader",props:{loading:{type:Boolean,default:!0},color:{type:String,default:"#5dc596"},size:{type:String,default:"15px"},margin:{type:String,default:"2px"},radius:{type:String,default:"100%"}},data(){return{spinnerStyle:{backgroundColor:this.color,width:this.size,height:this.size,margin:this.margin,borderRadius:this.radius,display:"inline-block",animationName:"v-pulseStretchDelay",animationDuration:"0.75s",animationIterationCount:"infinite",animationTimingFunction:"cubic-bezier(.2,.68,.18,1.08)",animationFillMode:"both"},spinnerDelay1:{animationDelay:"0.12s"},spinnerDelay2:{animationDelay:"0.24s"},spinnerDelay3:{animationDelay:"0.36s"}}}},o=n,r=(i("671b"),i("2877")),l=Object(r["a"])(o,a,s,!1,null,null,null);t["a"]=l.exports},b07d:function(e,t,i){"use strict";(function(e){var a=i("2b0e"),s=(i("9490"),i("bc3a")),n=i.n(s),o=i("8a5d"),r=i("130e"),l=i("4380"),c=i("5a30"),p=i.n(c),d=i("2f62");const u=i("df7c"),h="undefined"===typeof e.pkg;h?e.cwd():u.dirname(e.execPath),i("9490");i("30dc");a["a"].use(l["a"]),a["a"].use(r["a"],n.a),t["a"]={name:"Piece",computed:{...Object(d["b"])(["imageExist"])},data(){return{loadingTemplate:!0,loadingImage:!0,myId:Number,idImage:"",testName:Boolean,file:Blob,errors:[],piece:{title:"",content:"",attachment:""},image:"",selectedFile:null,pieces:[],likes:0,dislikes:0,posts:{title:"",content:"",attachment:"",loading:!1},color:"#071b46",color1:"red",size:"45px",margin:"2px",radius:"2px"}},components:{PulseLoader:o["a"]},created(){let e=localStorage.getItem("obj"),t=JSON.parse(e),i=t.myId;setTimeout(()=>{n.a.get("https://212.227.142.69:3000/api/piece/").then(e=>{this.myId=i,this.pieces=e.data}).catch(e=>console.log(e())).finally(()=>this.loadingTemplate=!1)},1e3)},methods:{resetForm(){console.log("Reseting the form");var e=this;Object.keys(this.piece).forEach((function(t,i){e.piece[t]=""}))},doLike:function(e){let t=localStorage.getItem("obj"),i=JSON.parse(t),a=i.myToken;this.axios.post("https://212.227.142.69:3000/api/pieces/"+e+"/vote/like",null,{headers:{Authorization:a}}).then(()=>{n.a.get("https://212.227.142.69:3000/api/piece/").then(e=>this.pieces=e.data).catch(e=>console.log(e()))}).catch(e=>console.log(e()))},doDislike:function(e){let t=localStorage.getItem("obj"),i=JSON.parse(t),a=i.myToken;this.axios.post("https://212.227.142.69:3000/api/pieces/"+e+"/vote/dislike",null,{headers:{Authorization:a}}).then(()=>{n.a.get("https://212.227.142.69:3000/api/piece/").then(e=>this.pieces=e.data).catch(e=>console.log(e()))}).catch(e=>console.log(e()))},onPostData(e){if(e.preventDefault(),this.errors=[],this.piece.title?(this.piece.title.length>=30||this.piece.title.length<=3)&&this.errors.push("Votre titre doit comprendre entre 4 et 30 caractères."):this.errors.push("Veillez saisir le titre"),this.piece.content?(this.piece.content.length>=550||this.piece.content.length<=3)&&this.errors.push("Votre piece doit contenir entre 4 et 550 caractères."):this.errors.push("Veillez saisir le piece"),!this.errors.length)return console.log("Vérification des inputs --\x3e OK"),this.post(this.piece)},post:function(e,t){let i=localStorage.getItem("obj"),a=JSON.parse(i),s=a.myToken;this.axios.post("https://212.227.142.69:3000/api/piece/new/",e,{headers:{Authorization:s}}).then(e=>{this.piece=e.data,console.log("piece crée ok"),n.a.get("https://212.227.142.69:3000/api/piece/").then(e=>{this.pieces=e.data,this.resetForm(),this.image="",res.status(200).json(this.pieces)}).catch((function(e){e.statusCode=401}))}).catch((function(e){e.statusCode=401}))},onFileSelected(e){this.selectedFile=e.target.files[0];var t=e.target.files||e.dataTransfer.files;t.length&&this.createImage(t[0])},createImage(e,t){new Image;var i=new FileReader,a=this;i.onload=e=>{a.image=e.target.result},i.readAsDataURL(e),this.image||this.pushImage()},pushImage(e){let t=localStorage.getItem("obj"),a=JSON.parse(t),s=a.myToken;i("3022");var o=new p.a,r=document.querySelector("#file");console.log("Mon imageFile[0] :",r.files[0]),o.append("file",r.files[0]),setTimeout(()=>{n.a.post("https://212.227.142.69:3000/api/piece/upload",o,{headers:{Authorization:s,"Content-Type":"multipart/form-data"}}).then(e=>(console.log("valeure reçu par le back:",e.data),console.log("valeure res.data.idImage:",e.data.idImage),e.data.idImage)).then((function(e){const t=document.querySelector("#attachment");t.value="https://212.227.142.69:3000/images/"+e,t.dispatchEvent(new Event("input")),response.status(200).json({idImage:e})})).catch((function(e){e.statusCode=401})).finally(()=>this.loadingImage=!1)},1e3)},removeImage:function(e){let t=localStorage.getItem("obj"),i=JSON.parse(t),a=i.myToken;var s=this.selectedFile.name;console.log("Envoie dufichier pour écrasement",s);var o=new p.a;o.append("file",this.selectedFile),n.a.post("https://212.227.142.69:3000/api/pieces/delLienImage",o,{headers:{Authorization:a,"Content-Type":"multipart/form-data"}}),this.image="",console.log("Le fichier vient d'être effacé du navigateur"),this.piece.attachment="",console.log("L'url du fichier vient d'être effacé du formulaire"),e.preventDefault()},doDelete:function(e){let t=localStorage.getItem("obj"),i=JSON.parse(t),a=i.myToken;this.axios.post("https://212.227.142.69:3000/api/piece/"+e+"/del",null,{headers:{Authorization:a}}).then(e=>{console.log("Deleting piece-1"),n.a.get("https://212.227.142.69:3000/api/piece/").then(e=>{console.log("Deleting piece"),this.pieces=e.data,this.resetForm(),res.status(200).json(this.pieces)}).catch((function(e){e.statusCode=401}))}).catch((function(e){e.statusCode=401}))}}}}).call(this,i("4362"))},c79f:function(e,t,i){"use strict";i("fa5e")},fa5e:function(e,t,i){}}]);
//# sourceMappingURL=piece.vue.c63a64d0.js.map