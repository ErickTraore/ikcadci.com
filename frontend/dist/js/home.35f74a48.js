(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["home"],{"21bb":function(e,t,s){"use strict";s("2dad")},"2dad":function(e,t,s){},"671b":function(e,t,s){"use strict";s("73af")},"73af":function(e,t,s){},"8a5d":function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"v-spinner"},[s("div",{staticClass:"v-pulse v-pulse1",style:[e.spinnerStyle,e.spinnerDelay1]}),s("div",{staticClass:"v-pulse v-pulse2",style:[e.spinnerStyle,e.spinnerDelay2]}),s("div",{staticClass:"v-pulse v-pulse3",style:[e.spinnerStyle,e.spinnerDelay3]})])},i=[],n={name:"PulseLoader",props:{loading:{type:Boolean,default:!0},color:{type:String,default:"#5dc596"},size:{type:String,default:"15px"},margin:{type:String,default:"2px"},radius:{type:String,default:"100%"}},data(){return{spinnerStyle:{backgroundColor:this.color,width:this.size,height:this.size,margin:this.margin,borderRadius:this.radius,display:"inline-block",animationName:"v-pulseStretchDelay",animationDuration:"0.75s",animationIterationCount:"infinite",animationTimingFunction:"cubic-bezier(.2,.68,.18,1.08)",animationFillMode:"both"},spinnerDelay1:{animationDelay:"0.12s"},spinnerDelay2:{animationDelay:"0.24s"},spinnerDelay3:{animationDelay:"0.36s"}}}},o=n,r=(s("671b"),s("2877")),l=Object(r["a"])(o,a,i,!1,null,null,null);t["a"]=l.exports},"9cae":function(e,t,s){"use strict";(function(e){var a=s("2b0e"),i=(s("9490"),s("bc3a")),n=s.n(i),o=s("8a5d"),r=s("130e"),l=s("4380"),c=s("5a30"),d=s.n(c),m=s("2f62");const g=s("df7c"),u="undefined"===typeof e.pkg;u?e.cwd():g.dirname(e.execPath),s("9490");s("30dc");a["a"].use(l["a"]),a["a"].use(r["a"],n.a),t["a"]={name:"Home",computed:{...Object(m["b"])(["imageExist"])},data(){return{loadingTemplate:!0,loadingImage:!0,myId:Number,idImage:"",testName:Boolean,file:Blob,errors:[],message:{title:"",content:"",attachment:""},image:"",selectedFile:null,messages:[],likes:0,dislikes:0,posts:{title:"",content:"",attachment:"",loading:!1},color:"#071b46",color1:"red",size:"45px",margin:"2px",radius:"2px"}},components:{PulseLoader:o["a"]},created(){let e=localStorage.getItem("obj"),t=JSON.parse(e),s=t.myId;setTimeout(()=>{n.a.get("https://212.227.142.69:3000/api/messages/").then(e=>{this.myId=s,this.messages=e.data}).catch(e=>console.log(e())).finally(()=>this.loadingTemplate=!1)},1e3)},methods:{resetForm(){console.log("Reseting the form");var e=this;Object.keys(this.message).forEach((function(t,s){e.message[t]=""}))},doLike:function(e){let t=localStorage.getItem("obj"),s=JSON.parse(t),a=s.myToken;this.axios.post("https://212.227.142.69:3000/api/messages/"+e+"/vote/like",null,{headers:{Authorization:a}}).then(()=>{n.a.get("https://212.227.142.69:3000/api/messages/").then(e=>this.messages=e.data).catch(e=>console.log(e()))}).catch(e=>console.log(e()))},doDislike:function(e){let t=localStorage.getItem("obj"),s=JSON.parse(t),a=s.myToken;this.axios.post("https://212.227.142.69:3000/api/messages/"+e+"/vote/dislike",null,{headers:{Authorization:a}}).then(()=>{n.a.get("https://212.227.142.69:3000/api/messages/").then(e=>this.messages=e.data).catch(e=>console.log(e()))}).catch(e=>console.log(e()))},onPostData(e){if(e.preventDefault(),this.errors=[],this.message.title?(this.message.title.length>=30||this.message.title.length<=3)&&this.errors.push("Votre titre doit comprendre entre 4 et 30 caractères."):this.errors.push("Veillez saisir le titre"),this.message.content?(this.message.content.length>=550||this.message.content.length<=3)&&this.errors.push("Votre message doit contenir entre 4 et 550 caractères."):this.errors.push("Veillez saisir le message"),!this.errors.length)return console.log("Vérification des inputs --\x3e OK"),this.post(this.message)},post:function(e,t){let s=localStorage.getItem("obj"),a=JSON.parse(s),i=a.myToken;this.axios.post("https://212.227.142.69:3000/api/messages/new/",e,{headers:{Authorization:i}}).then(e=>{this.message=e.data,console.log("message crée ok"),n.a.get("https://212.227.142.69:3000/api/messages/").then(e=>{this.messages=e.data,this.resetForm(),this.image="",res.status(200).json(this.messages)}).catch((function(e){e.statusCode=401}))}).catch((function(e){e.statusCode=401}))},onFileSelected(e){this.selectedFile=e.target.files[0];var t=e.target.files||e.dataTransfer.files;t.length&&this.createImage(t[0])},createImage(e,t){new Image;var s=new FileReader,a=this;s.onload=e=>{a.image=e.target.result},s.readAsDataURL(e),this.image||this.pushImage()},pushImage(e){let t=localStorage.getItem("obj"),a=JSON.parse(t),i=a.myToken;s("3022");var o=new d.a,r=document.querySelector("#file");console.log("Mon imageFile[0] :",r.files[0]),o.append("file",r.files[0]),setTimeout(()=>{n.a.post("https://212.227.142.69:3000/api/messages/upload",o,{headers:{Authorization:i,"Content-Type":"multipart/form-data"}}).then(e=>(console.log("valeure reçu par le back:",e.data),console.log("valeure res.data.idImage:",e.data.idImage),e.data.idImage)).then((function(e){const t=document.querySelector("#attachment");t.value="https://212.227.142.69:3000/images/"+e,t.dispatchEvent(new Event("input")),response.status(200).json({idImage:e})})).catch((function(e){e.statusCode=401})).finally(()=>this.loadingImage=!1)},1e3)},removeImage:function(e){let t=localStorage.getItem("obj"),s=JSON.parse(t),a=s.myToken;var i=this.selectedFile.name;console.log("Envoie dufichier pour écrasement",i);var o=new d.a;o.append("file",this.selectedFile),n.a.post("https://212.227.142.69:3000/api/messages/delLienImage",o,{headers:{Authorization:a,"Content-Type":"multipart/form-data"}}),this.image="",console.log("Le fichier vient d'être effacé du navigateur"),this.message.attachment="",console.log("L'url du fichier vient d'être effacé du formulaire"),e.preventDefault()},doDelete:function(e){let t=localStorage.getItem("obj"),s=JSON.parse(t),a=s.myToken;this.axios.post("https://212.227.142.69:3000/api/messages/"+e+"/del",null,{headers:{Authorization:a}}).then(e=>{console.log("Deleting message-1"),n.a.get("https://212.227.142.69:3000/api/messages/").then(e=>{console.log("Deleting message"),this.messages=e.data,this.resetForm(),res.status(200).json(this.messages)}).catch((function(e){e.statusCode=401}))}).catch((function(e){e.statusCode=401}))}}}}).call(this,s("4362"))},bb51:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"group"},[e.loadingTemplate?s("div",{staticClass:"progress conteneur"},[s("pulse-loader",{attrs:{loading:e.loading,color:e.color,size:e.size}})],1):s("div",[s("div",{staticClass:"group__header",attrs:{id:"app"}},[s("div",{staticClass:"group__header__body"},e._l(e.messages,(function(t){return s("div",{key:t.id,staticClass:"container"},[s("div",{staticClass:"group__header__body__first"},[s("div",{staticClass:"group__header__body__first__in"},[s("img",{attrs:{src:t.attachment}}),e._m(0,!0),s("b",[e._v(e._s(t.User.username))]),e._v(" à écrit le "+e._s(e._f("dateFormat")(new Date(t.createdAt),"DD/MM/YYYY"))+" à "+e._s(e._f("dateFormat")(new Date(t.createdAt),"hh:mm"))+" : "),s("br"),s("div",{staticClass:"group__header__body__first__title"},[e._v(" Titre: "+e._s(t.title)+" ")])]),s("div",{staticClass:"group__header__body__first__down"},[e._v(" "+e._s(t.content)),s("br")])]),s("div",{staticClass:"position like-buttons group__header__body__second",attrs:{"_ngcontent-cpa-c6":""}},[s("div",{staticClass:"left"},[s("div",{staticClass:"likes",attrs:{"_ngcontent-cpa-c6":""}},[s("button",{attrs:{id:"dolike"},on:{click:function(s){return e.doLike(t.id)}}},[s("i",{staticClass:"like fa-thumbs-up fa-lg far",attrs:{"_ngcontent-cpa-c6":""}})]),s("span",{staticClass:"spanLikes",attrs:{"_ngcontent-cpa-c6":""}},[e._v(e._s(t.likes))])]),s("div",{staticClass:"dislikes",attrs:{"_ngcontent-cpa-c6":""}},[s("button",{on:{click:function(s){return e.doDislike(t.id)}}},[s("i",{staticClass:"dislike fa-thumbs-down fa-lg far",attrs:{"_ngcontent-cpa-c6":""}})]),s("span",{staticClass:"spanDislikes",attrs:{"_ngcontent-cpa-c6":""}},[e._v(e._s(t.dislikes))])])]),s("div",{staticClass:"right"},[s("div",{staticClass:"dislikes",attrs:{"_ngcontent-cpa-c6":""}},[e.myId==t.UserId?s("button",{staticClass:"btn-1",on:{click:function(s){return e.doDelete(t.id)}}},[e._v(" Suppression ! ")]):e._e()])])]),s("ul")])})),0),s("div",{staticClass:"group__header__body"},[s("form",{attrs:{method:"post",enctype:"multipart/form-data",name:"message"},on:{submit:e.onPostData}},[s("label",{staticClass:"labelForm"},[e._v("Nouveau message avec image optionnelle")]),e._v(" "),s("br"),e._v(" "),s("br"),e.errors.length?s("p",[s("b",[e._v("Merci de corriger les erreurs suivantes : ")]),s("ul",e._l(e.errors,(function(t){return s("li",{key:t},[e._v(e._s(t))])})),0)]):e._e(),s("input",{directives:[{name:"model",rawName:"v-model",value:e.message.title,expression:"message.title"}],attrs:{id:"title",type:"text",name:"title",placeholder:"Titre"},domProps:{value:e.message.title},on:{input:function(t){t.target.composing||e.$set(e.message,"title",t.target.value)}}}),e._v(" "),s("br"),e._v(" "),s("br"),s("input",{directives:[{name:"model",rawName:"v-model",value:e.message.content,expression:"message.content"}],attrs:{id:"content",type:"text",name:"content",placeholder:"Contenu"},domProps:{value:e.message.content},on:{input:function(t){t.target.composing||e.$set(e.message,"content",t.target.value)}}}),s("input",{directives:[{name:"model",rawName:"v-model",value:e.message.attachment,expression:"message.attachment"}],attrs:{id:"attachment",type:"hidden",name:"attachment"},domProps:{value:e.message.attachment},on:{input:function(t){t.target.composing||e.$set(e.message,"attachment",t.target.value)}}}),s("br"),s("div",[e.image?s("div",[e.loadingImage?s("div",{staticClass:"progress"},[s("div",{staticClass:"value v-80 striped animate s-10"},[e._v("Chargement...")])]):s("div",[s("img",{attrs:{src:e.image}})]),s("button",{on:{click:e.removeImage}},[e._v("Remove image")])]):s("div",[s("h4",[e._v("Choisir une image")]),s("div",{attrs:{id:"list"}}),s("input",{attrs:{id:"file",type:"file",name:"attachment",alt:"example"},on:{change:e.onFileSelected}})])]),s("br"),s("br"),s("div"),s("button",{attrs:{type:"submit",value:"val"}},[e._v(" Envoyer")])])])])])])},i=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"progress-bar"}},[s("div")])}],n=s("9cae"),o=n["a"],r=(s("21bb"),s("2877")),l=Object(r["a"])(o,a,i,!1,null,null,null);t["default"]=l.exports}}]);
//# sourceMappingURL=home.35f74a48.js.map